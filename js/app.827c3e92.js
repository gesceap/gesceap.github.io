(function(e){function t(t){for(var r,o,i=t[0],l=t[1],u=t[2],c=0,h=[];c<i.length;c++)o=i[c],s[o]&&h.push(s[o][0]),s[o]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);d&&d(t);while(h.length)h.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,i=1;i<n.length;i++){var l=n[i];0!==s[l]&&(r=!1)}r&&(a.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},s={app:0},a=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var d=l;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var r=n("64a9"),s=n.n(r);s.a},"20e9":function(e,t,n){},"3e38":function(e,t,n){"use strict";var r=n("43dd"),s=n.n(r);s.a},"43dd":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);var r=n("2b0e"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("Looper"),e._m(0)],1)},a=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"sm"}},[n("a",{attrs:{href:"https://www.youtube.com/channel/UChvIb5lU1CswBTno6BCGG4Q",target:"_blank",rel:"noopener noreferrer"}},[n("img",{attrs:{alt:"YouTube",src:"/img/yt.png"}})]),n("a",{attrs:{href:"https://www.facebook.com/gesceap/",target:"_blank",rel:"noopener noreferrer"}},[n("img",{attrs:{alt:"Facebook",src:"/img/fb.png"}})]),n("a",{attrs:{href:"https://twitter.com/gesceap_",target:"_blank",rel:"noopener noreferrer"}},[n("img",{attrs:{alt:"Twitter",src:"/img/tw.png"}})]),n("a",{attrs:{href:"https://gesceap.bandcamp.com",target:"_blank",rel:"noopener noreferrer"}},[n("img",{attrs:{alt:"Bandcamp",src:"/img/bc.png"}})]),n("a",{attrs:{href:"https://github.com/gesceap",target:"_blank",rel:"noopener noreferrer"}},[n("img",{attrs:{alt:"GitHub",src:"/img/gh.png"}})]),n("a",{attrs:{href:"https://soundcloud.com/gesceap",target:"_blank",rel:"noopener noreferrer"}},[n("img",{attrs:{alt:"SoundCloud",src:"/img/sc.png"}})])])}],o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("main",[n("Background",{attrs:{playing:e.playing,sources:e.sources}}),e.loaded?n("div",{staticClass:"looper"},e._l(e.showSources,function(t,r){return n("Sample",{key:t.filename,attrs:{source:t,playing:e.playing.find(function(e){return e.filename===t.filename}),queuedIn:e.playing.length&&e.startQueue.indexOf(r)>-1,queuedOut:e.endQueue.indexOf(r)>-1},on:{sampleClick:e.queueSample}})}),1):n("div",{staticClass:"loading"},[e._v("Loading 19.2MB please wait")])],1)},i=[],l=n("e295"),u=n.n(l),d=n("1fc0"),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("canvas",{ref:"canvas"})},h=[],p=n("c9a3"),f=n.n(p);const g=new r["a"];function w(e,t,n,r,s,a,o,i){const l=t,u=2*Math.PI/n,d=a*Math.cos(u*l)+r,c=a*Math.sin(u*l)+s;return i&&(e.beginPath(),e.arc(d,c,o,0,2*Math.PI),e.fill()),[d,c]}function m({context:e,numPoints:t,width:n,height:r,dpr:s}){e.fillStyle="#fff",e.strokeStyle="#fff",e.lineWidth=1*s;const a=[];for(let o=0;o<t;o+=1)a.push(w(e,o,t,n/2,r/2,n/2,2*s,!1));for(let o=0;o<a.length;o+=1){const t=a[o][0],n=a[o][1];for(let r=0;r<a.length;r+=1){const s=a[r][0],o=a[r][1];e.beginPath(),e.moveTo(t,n),e.lineTo(s,o),e.stroke()}}}const y=10.5,x=20;var v={0:{draw({context:e,delta:t,x:n,y:r,squareSize:s,dpr:a,features:{energy:o}}){e.save(),e.translate(n+y-o,r+y-o),m({delta:t,context:e,width:s-x+2*o,height:s-x+2*o,dpr:a,numPoints:2}),e.restore()}},1:{draw({context:e,delta:t,x:n,y:r,squareSize:s,dpr:a,features:{energy:o}}){e.save(),e.translate(n+y-o,r+y-o),m({delta:t,context:e,width:s-x+2*o,height:s-x+2*o,dpr:a,numPoints:3}),e.restore()}},2:{draw({context:e,delta:t,x:n,y:r,squareSize:s,dpr:a,features:{energy:o}}){e.save(),e.translate(n+y-o,r+y-o),m({delta:t,context:e,width:s-x+2*o,height:s-x+2*o,dpr:a,numPoints:4}),e.restore()}},3:{draw({context:e,delta:t,x:n,y:r,squareSize:s,dpr:a,features:{energy:o}}){e.save(),e.translate(n+y-o,r+y-o),m({delta:t,context:e,width:s-x+2*o,height:s-x+2*o,dpr:a,numPoints:5}),e.restore()}},4:{draw({context:e,delta:t,x:n,y:r,squareSize:s,dpr:a,features:{energy:o}}){e.save(),e.translate(n+y-o,r+y-o),m({delta:t,context:e,width:s-x+2*o,height:s-x+2*o,dpr:a,numPoints:6}),e.restore()}},5:{draw({context:e,delta:t,x:n,y:r,squareSize:s,dpr:a,features:{energy:o}}){e.save(),e.translate(n+y-o,r+y-o),m({delta:t,context:e,width:s-x+2*o,height:s-x+2*o,dpr:a,numPoints:7}),e.restore()}},6:{draw({context:e,delta:t,x:n,y:r,squareSize:s,dpr:a,features:{energy:o}}){e.save(),e.translate(n+y-o,r+y-o),m({delta:t,context:e,width:s-x+2*o,height:s-x+2*o,dpr:a,numPoints:8}),e.restore()}},7:{draw({context:e,delta:t,x:n,y:r,squareSize:s,dpr:a,features:{energy:o}}){e.save(),e.translate(n+y-o,r+y-o),m({delta:t,context:e,width:s-x+2*o,height:s-x+2*o,dpr:a,numPoints:9}),e.restore()}},8:{draw({context:e,delta:t,x:n,y:r,squareSize:s,dpr:a,features:{energy:o}}){e.save(),e.translate(n+y-o,r+y-o),m({delta:t,context:e,width:s-x+2*o,height:s-x+2*o,dpr:a,numPoints:10}),e.restore()}},9:{draw({context:e,delta:t,x:n,y:r,squareSize:s,dpr:a,features:{energy:o}}){e.save(),e.translate(n+y-o,r+y-o),m({delta:t,context:e,width:s-x+2*o,height:s-x+2*o,dpr:a,numPoints:11}),e.restore()}},10:{draw({context:e,delta:t,x:n,y:r,squareSize:s,dpr:a,features:{energy:o}}){e.save(),e.translate(n+y-o,r+y-o),m({delta:t,context:e,width:s-x+2*o,height:s-x+2*o,dpr:a,numPoints:12}),e.restore()}},11:{draw({context:e,delta:t,x:n,y:r,squareSize:s,dpr:a,features:{energy:o}}){e.save(),e.translate(n+y-o,r+y-o),m({delta:t,context:e,width:s-x+2*o,height:s-x+2*o,dpr:a,numPoints:13}),e.restore()}},12:{draw({context:e,delta:t,x:n,y:r,squareSize:s,dpr:a,features:{energy:o}}){e.save(),e.translate(n+y-o,r+y-o),m({delta:t,context:e,width:s-x+2*o,height:s-x+2*o,dpr:a,numPoints:14}),e.restore()}},13:{draw({context:e,delta:t,x:n,y:r,squareSize:s,dpr:a,features:{energy:o}}){e.save(),e.translate(n+y-o,r+y-o),m({delta:t,context:e,width:s-x+2*o,height:s-x+2*o,dpr:a,numPoints:15}),e.restore()}},14:{draw({context:e,delta:t,x:n,y:r,squareSize:s,dpr:a,features:{energy:o}}){e.save(),e.translate(n+y-o,r+y-o),m({delta:t,context:e,width:s-x+2*o,height:s-x+2*o,dpr:a,numPoints:16}),e.restore()}},15:{draw({context:e,delta:t,x:n,y:r,squareSize:s,dpr:a,features:{energy:o}}){e.save(),e.translate(n+y-o,r+y-o),m({delta:t,context:e,width:s-x+2*o,height:s-x+2*o,dpr:a,numPoints:17}),e.restore()}}},b={props:["sources","playing"],data(){return{context:null,raf:null,dpr:1,squareSize:135,marginSize:2,maxSize:546,fill:"rgba(0,0,0,0)",animations:v,tick:!1,noise:null}},mounted(){const{canvas:e}=this.$refs;this.context=e.getContext("2d"),window.addEventListener("resize",this.resize),this.resize(),g.$on("loop",e=>{e%2===0?(this.fill="lime",this.tick=!0):this.tick=!1}),this.noise=new f.a("prime16"+Date.now()),this.raf=requestAnimationFrame(this.loop)},methods:{loop(e){this.raf=requestAnimationFrame(this.loop);const{dpr:t,context:n,maxSize:r,squareSize:s,marginSize:a,tick:o,noise:i}=this,{canvas:l}=n,{width:u,height:d}=l,c=e/2;n.drawImage(l,-8,-8,u+16,d+16);const h=i.noise2D(c/500,c/1064);n.drawImage(l,h,10*Math.sin(c/5e3+5*Math.sin(h/500))-Math.cos(c/500),u+20*h+Math.sin(c/500),d+20*Math.cos(h/600+2*Math.sin(c/500))),n.fillStyle="rgba(0,0,0,0.5)",n.fillRect(0,0,u,d);let p=-1;n.fillStyle=this.fill;for(let f=0;f<16;f++){const e=this.playing.findIndex(e=>e.index===f);if(f%4===0&&p++,e<0)continue;const i=this.sources[f].analyser&&this.sources[f].analyser.get(),h=u/2-r*t/2+(s*t*(f%4)+a*t*(f%4)),g=d/2-r*t/2+(s*t*p+a*t*p);this.animations[f]?(n.save(),this.animations[f].draw({canvas:l,context:n,delta:c,x:h,y:g,squareSize:s,tick:o,dpr:t,features:i}),n.restore()):n.fillRect(h,g,s*t,s*t)}this.fill="rgba(0,0,0,0)"},resize(){const{canvas:e}=this.$refs,{innerWidth:t,innerHeight:n}=window,{dpr:r}=this;e.width=t*r,e.height=n*r,e.style.width=`${t}px`,e.style.height=`${n}px`}}},S=b,q=(n("3e38"),n("2877")),P=Object(q["a"])(S,c,h,!1,null,"52972b5e",null),C=P.exports,k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{class:{sample:!0,playing:e.playingClass,queuedIn:e.queuedInClass,queuedOut:e.queuedOutClass},on:{click:e.emitClick}})},O=[],z={props:["source","playing","queuedIn","queuedOut"],data(){return{playingClass:!1,queuedInClass:!1,queuedOutClass:!1}},created(){g.$on("loop",this.handleClasses)},methods:{emitClick(){this.$emit("sampleClick",this.source),this.handleClasses()},handleClasses(e=0){const{playing:t,queuedIn:n,queuedOut:r}=this;this.playingClass=!1,this.queuedInClass=!1,this.queuedOutClass=!1,e%2===0&&(this.playingClass=!!t),this.queuedInClass=!!n,this.queuedOutClass=!!r}}},_=z,M=(n("951b"),Object(q["a"])(_,k,O,!1,null,"096901f8",null)),I=M.exports;try{window.AudioContext=window.AudioContext||window.webkitAudioContext,window.audioContext=new window.AudioContext}catch(ae){throw new Error("No Web Audio API support")}const A=function(e){this.context=e,this.bufferList={},this.playingSounds={},this.merger=this.context.createChannelMerger(1),this.merger.connect(this.context.destination)};A.prototype={addSound:function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer";var r=this;n.onload=function(){r.context.decodeAudioData(n.response,function(t){if(!t)throw new Error("Error decoding file data: "+e);r.bufferList[e]=t}),t&&t()},n.onerror=function(){throw new Error("BufferLoader: XHR error")},n.send()},stopSoundWithUrl:function(e,t){if(this.playingSounds.hasOwnProperty(e))for(var n in this.playingSounds[e])this.playingSounds[e].hasOwnProperty(n)&&this.playingSounds[e][n].stop(t)}};const $=new A(window.audioContext);window.webAudioAPISoundManager=$;const j=function(e,t){this.url=e,window.webAudioAPISoundManager=window.webAudioAPISoundManager||new A(window.audioContext),this.manager=window.webAudioAPISoundManager,this.manager.addSound(this.url,t)};j.prototype={play:function(e){var t=this.manager.bufferList[this.url];for(var n in this.settings={time:0,loop:!1,volume:.5},e)e.hasOwnProperty(n)&&(this.settings[n]=e[n]);if("undefined"!==typeof t){var r=this.makeSource(t);r.loop=this.settings.loop,r.start(this.settings.time),this.manager.playingSounds.hasOwnProperty(this.url)||(this.manager.playingSounds[this.url]=[]),this.manager.playingSounds[this.url].push(r)}},stop:function({time:e=0}){this.manager.stopSoundWithUrl(this.url,e)},makeSource:function(e){var t=this.manager.context.createBufferSource(),n=this.manager.context.createGain();return n.gain.value=this.settings.volume,t.buffer=e,t.connect(n),this.source=t,n.connect(this.manager.merger),t}};const E="/loops/",L=["Lecwd04-loops-r1-edited.wav","Inspo01-loops-r2-edited.wav","Brindisi-loops-r3-edited.wav","734-loops-r4-edited.wav","Lecwd04-loops-b1-edited.wav","Groovr02-loops-b2-edited.wav","Brindisi-loops-b3-edited.wav","Fastfood-loops-b4-edited.wav","Lecwd04-loops-s1-edited.wav","Groovr02-loops-s2-edited.wav","Brindisi-loops-s3-edited.wav","Fastfood-loops-s4-edited.wav","Lecwd04-loops-d1-edited.wav","Groovr02-loops-d2-edited.wav","Brindisi-loops-d3-edited.wav","Fastfood-loops-d4-edited.wav"],T=["r","b","s","d"];function B(e){return new Promise((t,n)=>{new j(e,t)})}function Q(e,t){return new Promise(async n=>{const r=`${E}${e}`;await B(r),n({filename:e,type:T[t],playing:!1})})}async function G(){let e=-1;const t=await Promise.all(L.map((t,n)=>{return n%4===0&&e++,Q(t,e)}));return t}function F(e){return new d["a"](e,Object.assign({},u.a))}let U=null,W=null;const N=25;let H,R=!1,D=130;const J=.1;let X=0;const Y={};var K={name:"Looper",data(){return{loaded:!1,counter:0,sources:[],showSources:[],startQueue:[],endQueue:[],baseUrl:"/loops/"}},components:{Background:C,Sample:I},computed:{playing(){const e=[];return this.sources.forEach((t,n)=>{if(!t.playing)return!1;e.push({...t,index:n})}),e}},async created(){function e(e){return new Promise(t=>setTimeout(t,e))}U=$.context,W=new Worker("/metronome-worker.js"),W.onmessage=e=>{"tick"===e.data&&this.scheduler()},W.postMessage({interval:N}),this.analyser=F({audioContext:$.context,source:$.merger,bufferSize:256,featureExtractors:["rms","energy","buffer"]}),this.$set(this,"sources",await G()),this.loaded=!0;for(let t=0;t<this.sources.length;++t)this.showSources.push(this.sources[t]),await e(100)},methods:{startInterval(){return R=!R,R?(H=0,X=U.currentTime,W.postMessage("start"),"stop"):(W.postMessage("stop"),"play")},scheduler(){while(X<U.currentTime+J)this.scheduleNote(H,X),this.nextNote()},scheduleNote(e,t){const{startQueue:n,endQueue:r}=this;if(e%64===0){for(let e=0;e<r.length;++e)this.stopSample(r[e]);for(let e=0;e<this.playing.length;++e)this.startSample(this.playing[e].index,t);for(let e=0;e<n.length;++e)this.startSample(n[e],t);n.splice(0,n.length),r.splice(0,r.length)}e%4===0&&g.$emit("loop")},nextNote(){const e=60/D;X+=.25*e,H++,64===H&&(H=0)},queueSample(e){const t=e.filename,{endQueue:n,startQueue:r}=this,s=this.sources.findIndex(e=>e.filename===t);if(this.playing.length||this.startInterval(),s>-1){const e=this.sources[s].type,t=this.playing.find(t=>t.type===e),a=r.reduce((t,n,r)=>{return this.sources[n].type===e&&t.push(r),t},[]),o=!!a.length;r.indexOf(s)>-1?r.splice(r.indexOf(s),1):this.sources[s].playing&&n.indexOf(s)>-1?(n.splice(n.indexOf(s),1),o&&r.splice(r.indexOf(s),1)):this.sources[s].playing?n.push(s):(t&&n.push(t.index),o&&a.forEach(e=>{r.splice(e,1)}),r.push(s))}},startSample(e,t){const{baseUrl:n}=this,r=this.sources[e].filename;this.sources[e].playing=!0;const s=new j(`${n}${r}`);s.play({time:t}),this.sources[e].analyser=this.analyser,Y[r]&&delete Y[r],Y[r]=s},stopSample(e){this.sources[e].playing=!1}}},V=K,Z=(n("9537"),Object(q["a"])(V,o,i,!1,null,"24d2b558",null)),ee=Z.exports,te={name:"App",components:{Looper:ee},created(){console.log("%c2xAA (https://wray.pro)","background-image: linear-gradient(to left, #c30083, #0623c8); color: #ffffff; padding: 5px 20px;")}},ne=te,re=(n("034f"),Object(q["a"])(ne,s,a,!1,null,null,null)),se=re.exports;r["a"].config.productionTip=!1,new r["a"]({render:e=>e(se)}).$mount("#app")},"64a9":function(e,t,n){},8898:function(e,t,n){},"951b":function(e,t,n){"use strict";var r=n("8898"),s=n.n(r);s.a},9537:function(e,t,n){"use strict";var r=n("20e9"),s=n.n(r);s.a}});
//# sourceMappingURL=app.827c3e92.js.map