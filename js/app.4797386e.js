(function(e){function t(t){for(var s,o,a=t[0],l=t[1],u=t[2],d=0,h=[];d<a.length;d++)o=a[d],i[o]&&h.push(i[o][0]),i[o]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);c&&c(t);while(h.length)h.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],s=!0,a=1;a<n.length;a++){var l=n[a];0!==i[l]&&(s=!1)}s&&(r.splice(t--,1),e=o(o.s=n[0]))}return e}var s={},i={app:0},r=[];function o(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=s,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(n,s,function(t){return e[t]}.bind(null,s));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],l=a.push.bind(a);a.push=t,a=a.slice();for(var u=0;u<a.length;u++)t(a[u]);var c=l;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var s=n("64a9"),i=n.n(s);i.a},"09a2":function(e,t,n){},"1bad":function(e,t,n){"use strict";var s=n("810b"),i=n.n(s);i.a},"1cc3":function(e,t,n){"use strict";var s=n("5f0e"),i=n.n(s);i.a},"3cb7":function(e,t,n){e.exports=n.p+"img/mystic-rose.f4ff0f44.png"},"4def":function(e,t,n){e.exports=n.p+"media/wind.db59c117.ogg"},"56d7":function(e,t,n){"use strict";n.r(t);var s=n("2b0e"),i=n("8c4f"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[e.webaudioShieldAccepted?n("RouterView"):e._e(),e._m(0),e.webaudioShieldAccepted?e._e():n("div",{staticClass:"web-audio-sheild"},[n("button",{on:{click:e.clickBegin}},[e._v("Begin")])])],1)},o=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"sm"}},[n("a",{attrs:{href:"https://www.youtube.com/channel/UChvIb5lU1CswBTno6BCGG4Q",target:"_blank",rel:"noopener noreferrer"}},[n("img",{attrs:{alt:"YouTube",src:"/img/yt.png"}})]),n("a",{attrs:{href:"https://www.facebook.com/gesceap/",target:"_blank",rel:"noopener noreferrer"}},[n("img",{attrs:{alt:"Facebook",src:"/img/fb.png"}})]),n("a",{attrs:{href:"https://twitter.com/gesceap_",target:"_blank",rel:"noopener noreferrer"}},[n("img",{attrs:{alt:"Twitter",src:"/img/tw.png"}})]),n("a",{attrs:{href:"https://gesceap.bandcamp.com",target:"_blank",rel:"noopener noreferrer"}},[n("img",{attrs:{alt:"Bandcamp",src:"/img/bc.png"}})]),n("a",{attrs:{href:"https://github.com/gesceap",target:"_blank",rel:"noopener noreferrer"}},[n("img",{attrs:{alt:"GitHub",src:"/img/gh.png"}})]),n("a",{attrs:{href:"https://soundcloud.com/gesceap",target:"_blank",rel:"noopener noreferrer"}},[n("img",{attrs:{alt:"SoundCloud",src:"/img/sc.png"}})])])}],a={created(){console.log("%c2xAA (https://wray.pro)","background-image: linear-gradient(to left, #c30083, #0623c8); color: #ffffff; padding: 5px 20px;")},data(){return{webaudioShieldAccepted:!1}},methods:{clickBegin(){this.webaudioShieldAccepted=!0}}},l=a,u=(n("034f"),n("2877")),c=Object(u["a"])(l,r,o,!1,null,null,null),d=c.exports,h=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("audio",{ref:"wind",attrs:{autoplay:"",loop:""}},[s("source",{attrs:{src:n("a817"),type:"audio/mpeg"}}),s("source",{attrs:{src:n("4def"),type:"audio/ogg"}})]),s("audio",{ref:"track",attrs:{preload:""},on:{ended:e.trackEnded}},[s("source",{attrs:{src:n("7a11"),type:"audio/mp3"}}),s("source",{attrs:{src:n("97f4"),type:"audio/ogg"}})]),s("div",{staticClass:"background-container"},[s("video",{attrs:{src:n("e81c"),autoplay:"",loop:"",muted:""},domProps:{muted:!0}})]),s("div",{staticClass:"foreground-container"},[s("button",{attrs:{"aria-label":"Play/Pause"},on:{click:e.clickRose}},[s("img",{attrs:{src:n("3cb7"),alt:"Mystic Rose"}})])])])},p=[],f={data(){return{trackPlaying:!1,prime16Timer:null}},methods:{async clickRose(){this.trackPlaying=!this.trackPlaying,this.trackPlaying?(await this.$refs.wind.pause(),await this.$refs.track.play(),this.prime16Timer&&(clearTimeout(this.prime16Timer),this.prime16Timer=null)):(await this.$refs.wind.play(),await this.$refs.track.pause())},async trackEnded(){this.$refs.track.currentTime=0,this.clickRose(),setTimeout(()=>{this.$router.push("/prime16")},5e3)}}},m=f,g=(n("a8a9"),Object(u["a"])(m,h,p,!1,null,null,null)),w=g.exports,y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Looper")],1)},b=[],v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("main",[e.loaded?n("Background",{attrs:{playing:e.playing,sources:e.sources,"stop-animating":e.stopAnimating}}):e._e(),e.loaded?n("div",{staticClass:"square"},[n("div",{staticClass:"looper"},e._l(e.showSources,function(t,s){return n("Sample",{key:t.filename,attrs:{source:t,playing:e.playing.find(function(e){return e.filename===t.filename}),queuedIn:e.playing.length&&e.startQueue.indexOf(s)>-1,queuedOut:e.endQueue.indexOf(s)>-1},on:{sampleClick:e.queueSample}})}),1)]):n("div",{staticClass:"loading"},[e._v("Loading 19.2MB please wait")])],1)},x=[],S=n("e295"),k=n.n(S),C=n("1fc0"),P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("canvas",{ref:"canvas"})},O=[],A=n("c9a3"),_=n.n(A);const $=new s["a"];function q(e,t,n,s,i,r,o,a){const l=t,u=2*Math.PI/n,c=r*Math.cos(u*l)+s,d=r*Math.sin(u*l)+i;return a&&(e.beginPath(),e.arc(c,d,o,0,2*Math.PI),e.fill()),[c,d]}function T({context:e,numPoints:t,width:n,height:s,dpr:i}){e.fillStyle="#fff",e.strokeStyle="#fff",e.lineWidth=1*i;const r=[];for(let o=0;o<t;o+=1)r.push(q(e,o,t,n/2,s/2,n/2,2*i,!1));for(let o=0;o<r.length;o+=1){const t=r[o][0],n=r[o][1];for(let s=0;s<r.length;s+=1){const i=r[s][0],o=r[s][1];e.beginPath(),e.moveTo(t,n),e.lineTo(i,o),e.stroke()}}}const M=10.5,I=20,B={},E=16;for(let ge=0;ge<E;++ge)B[ge]={draw:({context:e,delta:t,x:n,y:s,squareSize:i,dpr:r,features:{energy:o},stopAnimating:a})=>{let l,u;e.save(),a?(e.translate(n+M,s+M),l=i-I,u=i-I):(e.translate(n+M-o,s+M-o),l=i-I+2*o,u=i-I+2*o),T({delta:t,context:e,width:l,height:u,dpr:r,numPoints:2+ge}),e.restore()}};var W=B,j={props:["sources","playing","stopAnimating"],data(){return{context:null,raf:null,dpr:1,squareSize:135,marginSize:2,maxSize:546,fill:"rgba(0,0,0,0)",animations:W,tick:!1,noise:null}},mounted(){const{canvas:e}=this.$refs;this.context=e.getContext("2d"),window.addEventListener("resize",this.resize),this.resize(),$.$on("loop",e=>{e%2===0?(this.fill="lime",this.tick=!0):this.tick=!1}),this.noise=new _.a("prime16"+Date.now()),this.raf=requestAnimationFrame(this.loop)},methods:{loop(e){this.raf=requestAnimationFrame(this.loop);const{dpr:t,context:n,maxSize:s,squareSize:i,marginSize:r,tick:o,noise:a,stopAnimating:l}=this,{canvas:u}=n,{width:c,height:d}=u,h=e/2;l||n.drawImage(u,-8,-8,c+16,d+16);const p=a.noise2D(h/500,h/1064);l||n.drawImage(u,p,10*Math.sin(h/5e3+5*Math.sin(p/500))-Math.cos(h/500),c+20*p+Math.sin(h/500),d+20*Math.cos(p/600+2*Math.sin(h/500))),n.fillStyle="rgba(0,0,0,0.5)",n.fillRect(0,0,c,d);let f=-1;n.fillStyle=this.fill;for(let m=0;m<16;m++){const e=this.playing.findIndex(e=>e.index===m);if(m%4===0&&f++,e<0)continue;const a=this.sources[m].analyser&&this.sources[m].analyser.get(),p=c/2-s*t/2+(i*t*(m%4)+r*t*(m%4)),g=d/2-s*t/2+(i*t*f+r*t*f);this.animations[m]?(n.save(),this.animations[m].draw({canvas:u,context:n,delta:h,x:p,y:g,squareSize:i,tick:o,dpr:t,features:a,stopAnimating:l}),n.restore()):n.fillRect(p,g,i*t,i*t)}this.fill="rgba(0,0,0,0)"},resize(){const{canvas:e}=this.$refs,{innerWidth:t,innerHeight:n}=window,{dpr:s}=this;this.squareSize=document.querySelector(".sample").clientWidth,this.maxSize=document.querySelector(".looper").clientWidth,e.width=t*s,e.height=n*s,e.style.width=`${t}px`,e.style.height=`${n}px`}}},N=j,z=(n("1cc3"),Object(u["a"])(N,P,O,!1,null,"0d565b89",null)),L=z.exports,R=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{class:{sample:!0,playing:e.playingClass,queuedIn:e.queuedInClass,queuedOut:e.queuedOutClass},attrs:{name:e.source.name},on:{click:e.emitClick}})},Q=[],D={props:["source","playing","queuedIn","queuedOut"],data(){return{playingClass:!1,queuedInClass:!1,queuedOutClass:!1}},created(){$.$on("loop",this.handleClasses)},methods:{emitClick(){this.$emit("sampleClick",this.source),this.handleClasses()},handleClasses(e=0){const{playing:t,queuedIn:n,queuedOut:s}=this;this.playingClass=!1,this.queuedInClass=!1,this.queuedOutClass=!1,e%2===0&&(this.playingClass=!!t),this.queuedInClass=!!n,this.queuedOutClass=!!s}}},G=D,U=(n("1bad"),Object(u["a"])(G,R,Q,!1,null,"a2322aac",null)),F=U.exports;try{window.AudioContext=window.AudioContext||window.webkitAudioContext,window.audioContext=new window.AudioContext}catch(me){throw new Error("No Web Audio API support")}const H=function(e){this.context=e,this.bufferList={},this.playingSounds={},this.merger=this.context.createChannelMerger(1),this.merger.connect(this.context.destination)};H.prototype={addSound:function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer";var s=this;n.onload=function(){s.context.decodeAudioData(n.response,function(t){if(!t)throw new Error(`Error decoding file data: ${e}`);s.bufferList[e]=t}),t&&t()},n.onerror=function(){throw new Error("BufferLoader: XHR error")},n.send()},stopSoundWithUrl:function(e,t){if(this.playingSounds.hasOwnProperty(e))for(var n in this.playingSounds[e])this.playingSounds[e].hasOwnProperty(n)&&this.playingSounds[e][n].stop(t)}};const J=new H(window.audioContext);window.webAudioAPISoundManager=J;const X=function(e,t){this.url=e,window.webAudioAPISoundManager=window.webAudioAPISoundManager||new H(window.audioContext),this.manager=window.webAudioAPISoundManager,this.manager.addSound(this.url,t)};X.prototype={play:function(e){var t=this.manager.bufferList[this.url];for(var n in this.settings={time:0,loop:!1,volume:.5},e)e.hasOwnProperty(n)&&(this.settings[n]=e[n]);if("undefined"!==typeof t){var s=this.makeSource(t);s.loop=this.settings.loop,s.start(this.settings.time),this.manager.playingSounds.hasOwnProperty(this.url)||(this.manager.playingSounds[this.url]=[]),this.manager.playingSounds[this.url].push(s)}},stop:function({time:e=0}){this.manager.stopSoundWithUrl(this.url,e)},makeSource:function(e){var t=this.manager.context.createBufferSource(),n=this.manager.context.createGain();return n.gain.value=this.settings.volume,t.buffer=e,t.connect(n),this.source=t,n.connect(this.manager.merger),t}};const V="/loops/",Y=["Lecwd04-loops-r1-edited.wav","Inspo01-loops-r2-edited.wav","Brindisi-loops-r3-edited.wav","734-loops-r4-edited.wav","Lecwd04-loops-b1-edited.wav","Groovr02-loops-b2-edited.wav","Brindisi-loops-b3-edited.wav","Fastfood-loops-b4-edited.wav","Lecwd04-loops-s1-edited.wav","Groovr02-loops-s2-edited.wav","Brindisi-loops-s3-edited.wav","Fastfood-loops-s4-edited.wav","Lecwd04-loops-d1-edited.wav","Groovr02-loops-d2-edited.wav","Brindisi-loops-d3-edited.wav","Fastfood-loops-d4-edited.wav"],K=["Rhythm 1","Rhythm 2","Rhythm 3","Rhythm 4","Bass 1","Bass 2","Bass 3","Bass 4","Synth 1","Synth 2","Synth 3","Synth 4","Drum 1","Drum 2","Drum 3","Drum 4"],Z=["r","b","s","d"];function ee(e){return new Promise(t=>{new X(e,t)})}function te(e,t,n){return new Promise(async s=>{const i=`${V}${e}`;await ee(i),s({filename:e,name:n,type:Z[t],playing:!1})})}async function ne(){let e=-1;const t=await Promise.all(Y.map((t,n)=>{return n%4===0&&e++,te(t,e,K[n])}));return t}function se(e){return new C["a"](e,Object.assign({},k.a))}let ie=null;var re={name:"Looper",data(){return{loaded:!1,counter:0,sources:[],showSources:[],startQueue:[],endQueue:[],stopAnimating:!1,baseUrl:"/loops/",timerWorker:null,sampleStore:{},lookahead:25,isPlaying:!1,current16thNote:null,tempo:130,scheduleAheadTime:.1,nextNoteTime:0}},components:{Background:L,Sample:F},computed:{playing(){const e=[];return this.sources.forEach((t,n)=>{if(!t.playing)return!1;e.push({...t,index:n})}),e}},async created(){function e(e){return new Promise(t=>setTimeout(t,e))}ie=J.context,this.timerWorker=new Worker("/metronome-worker.js"),this.timerWorker.onmessage=e=>{"tick"===e.data&&this.scheduler()},this.timerWorker.postMessage({interval:this.lookahead}),this.analyser=se({audioContext:J.context,source:J.merger,bufferSize:256,featureExtractors:["rms","energy","buffer"]}),J.bufferList={},this.$set(this,"sources",await ne()),this.loaded=!0;for(let t=0;t<this.sources.length;++t)this.showSources.push(this.sources[t]),await e(100);window.toggleAnimating=()=>{this.stopAnimating=!this.stopAnimating}},beforeDestroy(){for(let e=0;e<16;e+=1)J.stopSoundWithUrl(`${this.baseUrl}${this.sources[e].filename}`);this.timerWorker.postMessage("stop"),this.timerWorker.terminate()},methods:{startInterval(){return this.isPlaying=!this.isPlaying,this.isPlaying?(this.current16thNote=0,this.nextNoteTime=ie.currentTime,this.timerWorker.postMessage("start"),"stop"):(this.timerWorker.postMessage("stop"),"play")},scheduler(){while(this.nextNoteTime<ie.currentTime+this.scheduleAheadTime)this.scheduleNote(this.current16thNote,this.nextNoteTime),this.nextNote()},scheduleNote(e,t){const{startQueue:n,endQueue:s}=this;if(e%64===0){for(let e=0;e<s.length;++e)this.stopSample(s[e]);for(let e=0;e<this.playing.length;++e)this.startSample(this.playing[e].index,t);for(let e=0;e<n.length;++e)this.startSample(n[e],t);n.splice(0,n.length),s.splice(0,s.length)}e%4===0&&$.$emit("loop")},nextNote(){const e=60/this.tempo;this.nextNoteTime+=.25*e,this.current16thNote++,64===this.current16thNote&&(this.current16thNote=0)},queueSample(e){const t=e.filename,{endQueue:n,startQueue:s}=this,i=this.sources.findIndex(e=>e.filename===t);if(this.playing.length||this.startInterval(),i>-1){const e=this.sources[i].type,t=this.playing.find(t=>t.type===e),r=s.reduce((t,n,s)=>{return this.sources[n].type===e&&t.push(s),t},[]),o=!!r.length;s.indexOf(i)>-1?s.splice(s.indexOf(i),1):this.sources[i].playing&&n.indexOf(i)>-1?(n.splice(n.indexOf(i),1),o&&s.splice(s.indexOf(i),1)):this.sources[i].playing?n.push(i):(t&&n.push(t.index),o&&r.forEach(e=>{s.splice(e,1)}),s.push(i))}},startSample(e,t){const{baseUrl:n}=this,s=this.sources[e].filename;this.sources[e].playing=!0;const i=new X(`${n}${s}`);i.play({time:t}),this.sources[e].analyser=this.analyser,this.sampleStore[s]&&delete this.sampleStore[s],this.sampleStore[s]=i},stopSample(e){this.sources[e].playing=!1}}},oe=re,ae=(n("ce6d"),Object(u["a"])(oe,v,x,!1,null,"7f5bf3b3",null)),le=ae.exports,ue={components:{Looper:le}},ce=ue,de=Object(u["a"])(ce,y,b,!1,null,null,null),he=de.exports,pe=[{path:"/",component:w},{path:"/prime16",component:he}];const fe=new i["a"]({mode:"history",routes:pe});s["a"].config.productionTip=!1,s["a"].use(i["a"]),new s["a"]({render:e=>e(d),router:fe}).$mount("#app")},"5f0e":function(e,t,n){},"64a9":function(e,t,n){},"7a11":function(e,t,n){e.exports=n.p+"media/track.d0c0a84d.mp3"},8016:function(e,t,n){},"810b":function(e,t,n){},"97f4":function(e,t,n){e.exports=n.p+"media/track.148d30d3.ogg"},a817:function(e,t,n){e.exports=n.p+"media/wind.cd199027.mp3"},a8a9:function(e,t,n){"use strict";var s=n("09a2"),i=n.n(s);i.a},ce6d:function(e,t,n){"use strict";var s=n("8016"),i=n.n(s);i.a},e81c:function(e,t,n){e.exports=n.p+"media/background.dec00ea1.mp4"}});
//# sourceMappingURL=app.4797386e.js.map